<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A collection of tools to manipulate and visualize Seurat objects data • RightSeuratTools</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A collection of tools to manipulate and visualize Seurat objects data">
<meta name="description" content="This package is a collection of various tools to facilitate the use of Seurat objects in R. It is intended to be used in conjunction with the Seurat package, and is not a standalone package. The package is currently in development and will be updated regularly with new functions and improvements.">
<meta property="og:description" content="This package is a collection of various tools to facilitate the use of Seurat objects in R. It is intended to be used in conjunction with the Seurat package, and is not a standalone package. The package is currently in development and will be updated regularly with new functions and improvements.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">RightSeuratTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Tutorial.html">Tutorial</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Alexis-Varin/RightSeuratTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rightseurattools">RightSeuratTools<a class="anchor" aria-label="anchor" href="#rightseurattools"></a>
</h1></div>
<!-- badges: start -->

<p>This package is a collection of various tools to facilitate the use of Seurat objects in R. It is intended to be used in conjunction with the Seurat package, and is not a standalone package. The package is currently in development and will be updated regularly with new functions and improvements, so be sure to check regularly for updates on this page.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"Alexis-Varin/RightSeuratTools"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="right_dietseurat">Right_DietSeurat<a class="anchor" aria-label="anchor" href="#right_dietseurat"></a>
</h2>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>As of Seurat v5 release, Seurat’s DietSeurat() function does not remove data and scale.data layers, resulting in objects with little to no reduction in size. This function was created with the purpose to restore DietSeurat()’s proper behavior until the function is fixed by Seurat’s dev team, as well as to offer a few new options such as the ability to subset cells or keep variable features.</p>
</div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<ul>
<li>Seurat version &gt;= 5.0.0</li>
<li>SeuratObject version &gt;= 5.0.0</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">Right_DietSeurat</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  seurat_object,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">idents =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">cells =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">features =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">dimreducs =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">graphs =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">variable.features =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">misc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">split.counts.layer =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="at">data.layer =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="at">scale.layer =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="at">SCTAssay =</span> <span class="cn">FALSE</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h3>
<table class="table">
<colgroup>
<col width="6%">
<col width="93%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th align="left">Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>seurat_object</strong></td>
<td align="left">A Seurat object.</td>
</tr>
<tr class="even">
<td><strong>idents</strong></td>
<td align="left">Character. A vector with one or several identity names in the meta.data slot to keep in the diet object. If NULL, all identities will be kept.</td>
</tr>
<tr class="odd">
<td><strong>cells</strong></td>
<td align="left">Character. A vector with one or several cell barcodes to keep in the diet object. If NULL, all cells will be kept.</td>
</tr>
<tr class="even">
<td><strong>features</strong></td>
<td align="left">Character. A vector with one or several feature names to keep in the diet object. If NULL, all features will be kept.</td>
</tr>
<tr class="odd">
<td><strong>dimreducs</strong></td>
<td align="left">Character. A vector with one or several reduction names to keep in the diet object. If NULL, all DimReducs will be removed. Note that if you subset features and remove all from which PCs were calculated, the PCA will not be kept even if it is specified in this parameter as the feature.loadings slot will be empty, this is intended behavior.</td>
</tr>
<tr class="even">
<td><strong>graphs</strong></td>
<td align="left">Character. A vector with one or several graph names to keep in the diet object. If NULL, all Graphs will be removed.</td>
</tr>
<tr class="odd">
<td><strong>variable.features</strong></td>
<td align="left">Logical. If TRUE, the variable features slot will be kept in the diet object. Note that if you keep only a subset of features, the variable features will also be subset, and if you remove all features from which variable features were determined, the variable features will not be kept even if this parameter is set to TRUE, this is intended behavior.</td>
</tr>
<tr class="even">
<td><strong>misc</strong></td>
<td align="left">Logical. If TRUE, the misc slot will be kept in the diet object.</td>
</tr>
<tr class="odd">
<td><strong>split.counts.layer</strong></td>
<td align="left">Character. The name of the identity to split the counts layers if you need to in your downstream analysis. If NULL, the diet object will have a single counts layer, even if the original object had split counts layers.</td>
</tr>
<tr class="even">
<td><strong>data.layer</strong></td>
<td align="left">Logical. If TRUE, the data layer of the RNA assay will be kept in the diet object if it is present. As with the counts layer, if there are split data layers, they will be joined into a single data layer unless the split.counts.layer parameter is specified.</td>
</tr>
<tr class="odd">
<td><strong>scale.layer</strong></td>
<td align="left">Logical. If TRUE, the scale.data layer of the RNA assay will be kept in the diet object if it is present. As with the counts layer, if there are split scale.data layers, they will be joined into a single scale.data layer unless the split.counts.layer parameter is specified.</td>
</tr>
<tr class="even">
<td><strong>SCTAssay</strong></td>
<td align="left">Logical. If TRUE, the SCT assay will be kept in the diet object if it is present.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p>A Seurat object, hopefully smaller, with class Assay5 RNA assay and specified layers and slots.</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">Right_DietSeurat</span>(pbmc_small,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                <span class="at">idents =</span> <span class="fu">c</span>(<span class="st">"letter.idents"</span>,<span class="st">"groups"</span>),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"CD3D"</span>, <span class="st">"NOSIP"</span>, <span class="st">"SAFB2"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                 <span class="st">"CD2"</span>, <span class="st">"IL7R"</span>, <span class="st">"PIK3IP1"</span>, <span class="st">"MAL"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                <span class="at">graphs =</span> <span class="st">"RNA_snn"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                <span class="at">split.counts.layer =</span> <span class="st">"letter.idents"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">Right_DietSeurat</span>(pbmc_small,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                <span class="at">cells =</span> <span class="fu">WhichCells</span>(pbmc_small, <span class="at">idents =</span> <span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"1"</span>)),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                <span class="at">variable.features =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>                <span class="at">dimreducs =</span> <span class="st">"pca"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                <span class="at">data.layer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="barplot_cell_proportion">Barplot_Cell_Proportion<a class="anchor" aria-label="anchor" href="#barplot_cell_proportion"></a>
</h2>
<div class="section level3">
<h3 id="description-1">Description<a class="anchor" aria-label="anchor" href="#description-1"></a>
</h3>
<p>This function generates a barplot of the proportion of cells from a Seurat object.</p>
</div>
<div class="section level3">
<h3 id="dependencies-1">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies-1"></a>
</h3>
<ul>
<li>Seurat</li>
<li>SeuratObject</li>
<li>ggplot2</li>
<li>patchwork</li>
<li>scales</li>
<li>grDevices</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">Barplot_Cell_Proportion</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  seurat_object,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">split.by =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">colors =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">order.proportion =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">order.group =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">order.split =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">order.colors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">show.cellsum.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">cellsum.label.size =</span> <span class="dv">3</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="at">axis.text.size =</span> <span class="dv">9</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="at">x.axis.angle =</span> <span class="dv">60</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="at">x.axis.hjust =</span> <span class="dv">1</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">y.axis.title.size =</span> <span class="dv">11</span>,</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">legend.text.size =</span> <span class="dv">9</span>,</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="at">split.plot.title.size =</span> <span class="dv">24</span>,</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="at">legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="at">percent =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="at">unique.group.plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="at">unique.split.plot =</span> <span class="cn">FALSE</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="16%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th align="left">Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>seurat_object</strong></td>
<td align="left">A Seurat object.</td>
</tr>
<tr class="even">
<td><strong>group.by</strong></td>
<td align="left">Character. The name of an identity to group the active ident by into a stacked barplot.</td>
</tr>
<tr class="odd">
<td><strong>split.by</strong></td>
<td align="left">The name of an identity to split the active ident by into separate ggplot objects.</td>
</tr>
<tr class="even">
<td><strong>colors</strong></td>
<td align="left">A vector of colors to be used. Seurat’s default colors will be used if NULL.</td>
</tr>
<tr class="odd">
<td><strong>order.proportion</strong></td>
<td align="left">Character. A vector specifying either “reverse” or the levels of the active ident to order the cells.</td>
</tr>
<tr class="even">
<td><strong>order.group</strong></td>
<td align="left">Character. A vector specifying either “reverse” or the levels of the group.by identity to order the cells. Ignored if group.by is NULL.</td>
</tr>
<tr class="odd">
<td><strong>order.split</strong></td>
<td align="left">Character. A vector specifying either “reverse” or the levels of the split.by identity to order the cells. Ignored if split.by is NULL.</td>
</tr>
<tr class="even">
<td><strong>order.colors</strong></td>
<td align="left">Logical. If TRUE, the colors will automatically be ordered according to order.proportion. Ignored if order.proportion is NULL.</td>
</tr>
<tr class="odd">
<td><strong>show.cellsum.label</strong></td>
<td align="left">Logical. If TRUE, the sum of cells of each identity will be shown at the top of each bar.</td>
</tr>
<tr class="even">
<td><strong>cellsum.label.size</strong></td>
<td align="left">Numeric. The size of the cell sum label. Ignored if show.cellsum.label is FALSE.</td>
</tr>
<tr class="odd">
<td><strong>axis.text.size</strong></td>
<td align="left">Numeric. The size of the x axis identities and y axis cell percent or numbers.</td>
</tr>
<tr class="even">
<td><strong>x.axis.angle</strong></td>
<td align="left">Numeric. The angle of the x axis identities.</td>
</tr>
<tr class="odd">
<td><strong>x.axis.hjust</strong></td>
<td align="left">Numeric. The horizontal justification of the x axis identities.</td>
</tr>
<tr class="even">
<td><strong>y.axis.title.size</strong></td>
<td align="left">Numeric. The size of the y axis title.</td>
</tr>
<tr class="odd">
<td><strong>legend.text.size</strong></td>
<td align="left">Numeric. The size of the legend text. Ignored if legend is FALSE.</td>
</tr>
<tr class="even">
<td><strong>legend.position</strong></td>
<td align="left">Character. Which side to display the legend, “left”, “right”, “top” or “bottom”. Ignored if legend is FALSE.</td>
</tr>
<tr class="odd">
<td><strong>split.plot.title.size</strong></td>
<td align="left">Numeric. The size of the plot titles. Ignored if split.by is NULL.</td>
</tr>
<tr class="even">
<td><strong>legend</strong></td>
<td align="left">Logical. If TRUE, the legend will be shown at the bottom of the ggplot object or patchwork.</td>
</tr>
<tr class="odd">
<td><strong>percent</strong></td>
<td align="left">Logical. If TRUE, the proportion should be shown as a percentage of total cells for each identity.</td>
</tr>
<tr class="even">
<td><strong>nrow</strong></td>
<td align="left">Numeric. The number of rows in the patchwork. Ignored if the function returns a ggplot object.</td>
</tr>
<tr class="odd">
<td><strong>unique.group.plot</strong></td>
<td align="left">Logical. If TRUE, the stacked proportion of cells will be gathered in a single ggplot object.</td>
</tr>
<tr class="even">
<td><strong>unique.split.plot</strong></td>
<td align="left">Logical. If TRUE, the ggplot objects will be gathered in a single patchwork.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output-1">Output<a class="anchor" aria-label="anchor" href="#output-1"></a>
</h3>
<p>A ggplot object, a list of ggplot objects, a patchwork of ggplot objects or a list of patchworks of ggplot objects.</p>
</div>
</div>
<div class="section level2">
<h2 id="dotplot_heatmap">DotPlot_Heatmap<a class="anchor" aria-label="anchor" href="#dotplot_heatmap"></a>
</h2>
<div class="section level3">
<h3 id="description-2">Description<a class="anchor" aria-label="anchor" href="#description-2"></a>
</h3>
<p>This function generates a dotplot or a heatmap to visualize features expression in a Seurat object. Credits to Seurat’s dev team for the original DotPlot() function from which data processing of this function is derived from and to <a href="https://divingintogeneticsandgenomics.com/post/clustered-dotplot-for-single-cell-rnaseq/" class="external-link uri">https://divingintogeneticsandgenomics.com/post/clustered-dotplot-for-single-cell-rnaseq/</a> for the initial idea to use ComplexHeatmap to draw a dotplot and the layer_fun function that draws the dots. Slight improvements were implemented here and there for my personal use, and made available to all through my package.</p>
</div>
<div class="section level3">
<h3 id="dependencies-2">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies-2"></a>
</h3>
<ul>
<li>Seurat version &gt;= 5.0.0</li>
<li>SeuratObject version &gt;= 5.0.0</li>
<li>grid</li>
<li>stats</li>
<li>ComplexHeatmap</li>
<li>grDevices</li>
<li>colorRamp2</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a>
</h3>
<p>TBD</p>
</div>
<div class="section level3">
<h3 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a>
</h3>
<p>TBD</p>
</div>
<div class="section level3">
<h3 id="output-2">Output<a class="anchor" aria-label="anchor" href="#output-2"></a>
</h3>
<p>A ComplexHeatmap object, either as a dotplot, or a heatmap, or a list containing a matrix of the expression data and another matrix containing the percent of cells expressing each feature.</p>
</div>
</div>
<div class="section level2">
<h2 id="grid_vlnplot">Grid_VlnPlot<a class="anchor" aria-label="anchor" href="#grid_vlnplot"></a>
</h2>
<div class="section level3">
<h3 id="description-3">Description<a class="anchor" aria-label="anchor" href="#description-3"></a>
</h3>
<p>This function is a stacked violin plot optimized to display features expression in a Seurat object in a grid fashion (square) instead of a single column like other stacked violin functions available in other packages, resulting in nicer plots and easier to include in publications.</p>
</div>
<div class="section level3">
<h3 id="dependencies-3">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies-3"></a>
</h3>
<ul>
<li>Seurat version &gt;= 5.0.0</li>
<li>SeuratObject version &gt;= 5.0.0</li>
<li>data.table</li>
<li>ggplot2</li>
<li>grDevices</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a>
</h3>
<p>TBD</p>
</div>
<div class="section level3">
<h3 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a>
</h3>
<p>TBD</p>
</div>
<div class="section level3">
<h3 id="output-3">Output<a class="anchor" aria-label="anchor" href="#output-3"></a>
</h3>
<p>A ggplot object.</p>
</div>
</div>
<div class="section level2">
<h2 id="gsea_signatures">GSEA_Signatures<a class="anchor" aria-label="anchor" href="#gsea_signatures"></a>
</h2>
<div class="section level3">
<h3 id="description-4">Description<a class="anchor" aria-label="anchor" href="#description-4"></a>
</h3>
<p>This function creates signatures (module scores calculated from UCell or Seurat’s respective functions) from the pathways’s genes present in the Seurat object.</p>
</div>
<div class="section level3">
<h3 id="dependencies-4">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies-4"></a>
</h3>
<ul>
<li>Seurat version &gt;= 5.0.0</li>
<li>SeuratObject version &gt;= 5.0.0</li>
<li>UCell</li>
<li>msigdbr</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">GSEA_Signatures</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  seurat_object,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">assay =</span> <span class="st">"RNA"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">layer =</span> <span class="st">"data"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">"Homo sapiens"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">category =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">subcategory =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">pathways =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">min.genes =</span> <span class="dv">2</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">signatures.names =</span> <span class="st">"name"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"UCell"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="at">only.genes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="at">fail.safe =</span> <span class="dv">10</span>,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  ...</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a>
</h3>
<table class="table">
<colgroup>
<col width="3%">
<col width="96%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th align="left">Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>seurat_object</strong></td>
<td align="left">A Seurat object.</td>
</tr>
<tr class="even">
<td><strong>assay</strong></td>
<td align="left">Character. If the Seurat object contains multiple RNA assays, you may specify which one to use (for example “RNA2” if you have created a second RNA assay you named “RNA2”. See Seurat v5 vignettes for more information). You may also use another assay such as SCT to pull gene expression from.</td>
</tr>
<tr class="odd">
<td><strong>layer</strong></td>
<td align="left">Character. Formerly known as slot. If you have split layers the function will always join them before adding the signatures.</td>
</tr>
<tr class="even">
<td><strong>species</strong></td>
<td align="left">Character. The species name to be passed to msigdbr to build the pathways database. Use msigdbr::msigdbr_species() for the list of available species.</td>
</tr>
<tr class="odd">
<td><strong>category</strong></td>
<td align="left">Character. The category or categories to be passed to msigdbr to build the pathways database. Use msigdbr::msigdbr_collections() for the list of available categories (gs_cat column). Leave NULL to use all categories.</td>
</tr>
<tr class="even">
<td><strong>subcategory</strong></td>
<td align="left">Character. The subcategory or subcategories to be passed to msigdbr to build the pathways database. Use msigdbr::msigdbr_collections() for the list of available subcategories (gs_subcat column). Leave NULL to use all subcategories.</td>
</tr>
<tr class="odd">
<td><strong>pathways</strong></td>
<td align="left">Character. The names of the pathways to be used to create the signatures. You may provide either a pathway id (for example, “<a href="GO:0006574" class="uri">GO:0006574</a>”) or a name matching the pattern found in msigdbr$gs_name (all caps and underscores between words). Please note that you may provide a partial match (for example, “TYPE_I_INTERFERON”) and the function will find all pathways containing this partial string. Beware that this may result in a large number of pathways to be added as signatures (using only.genes = TRUE is highly recommended) but is very handy to explore all pathways of interest in a particular field or biological process.</td>
</tr>
<tr class="even">
<td><strong>min.genes</strong></td>
<td align="left">Numeric. The minimum number of genes present in the Seurat object for a pathway to be considered.</td>
</tr>
<tr class="odd">
<td><strong>signatures.names</strong></td>
<td align="left">Character. “id” will add pathways ids as signatures (e.g. <a href="GO:0004657" class="uri">GO:0004657</a>, hsa05200 etc), “name” will add pathways names as signatures, which might be very long. You may also provide a vector of names to be used as signatures, whose length must match the number of pathways found and kept. It is recommended to use only.genes = TRUE and set signatures.names = “name” or “id” to get the number of signatures you need to provide names for.</td>
</tr>
<tr class="even">
<td><strong>method</strong></td>
<td align="left">Character. The method you want to use to calculate the module scores, either “UCell” or “Seurat”.</td>
</tr>
<tr class="odd">
<td><strong>only.genes</strong></td>
<td align="left">Logical. If TRUE, the function will not add any signature to the Seurat object and will only return the Seurat object as well as the genes from the pathways found in the Seurat object and the genes present in the Seurat object.</td>
</tr>
<tr class="even">
<td><strong>fail.safe</strong></td>
<td align="left">Numeric. The maximum number of signatures the function will attempt to add to the Seurat object. If the number of signatures found is higher than this number, the function will not add any signature to the Seurat object and will only return the Seurat object as well as the genes from the pathways found in the Seurat object and the genes present in the Seurat object.</td>
</tr>
<tr class="odd">
<td><strong>verbose</strong></td>
<td align="left">Logical. If FALSE, does not print progress messages and output, but warnings and errors will still be printed.</td>
</tr>
<tr class="even">
<td><strong>…</strong></td>
<td align="left">Additional arguments to be passed to UCell’s or Seurat’s AddModuleScore() function.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output-4">Output<a class="anchor" aria-label="anchor" href="#output-4"></a>
</h3>
<p>A list containing the Seurat object with the added signatures if only.genes = FALSE, the genes from the pathways, the genes present in the Seurat object and the names of the signatures in the Seurat object.</p>
</div>
</div>
<div class="section level2">
<h2 id="find_annotation_markers">Find_Annotation_Markers<a class="anchor" aria-label="anchor" href="#find_annotation_markers"></a>
</h2>
<div class="section level3">
<h3 id="description-5">Description<a class="anchor" aria-label="anchor" href="#description-5"></a>
</h3>
<p>This function is a wrapper around Seurat’s FindMarkers function that allows for parallelization and filtering of mitochondrial, ribosomal and non-coding RNA genes in human, as well as filtering of pseudogenes in mouse. It will also directly give the top X markers for each identity to use for plotting with DotPlot_Heatmap() for example.</p>
</div>
<div class="section level3">
<h3 id="dependencies-5">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies-5"></a>
</h3>
<ul>
<li>Seurat version &gt;= 5.0.0</li>
<li>SeuratObject version &gt;= 5.0.0</li>
<li>future</li>
<li>future.apply</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a>
</h3>
<p>TBD</p>
</div>
<div class="section level3">
<h3 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a>
</h3>
<p>TBD</p>
</div>
<div class="section level3">
<h3 id="output-5">Output<a class="anchor" aria-label="anchor" href="#output-5"></a>
</h3>
<p>A data frame or a list of data frames with gene names and associated statistics, or a character vector or a list of character vectors with gene names.</p>
</div>
<div class="section level3">
<h3 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a>
</h3>
<p>TBD</p>
</div>
</div>
<div class="section level2">
<h2 id="about-the-author">About the Author<a class="anchor" aria-label="anchor" href="#about-the-author"></a>
</h2>
<p>Alexis Varin, PhD</p>
<p>Inserm Research Engineer in Bioinformatics Analyses</p>
<p>Inserm UMR Right</p>
<p>Bureau 205, 2ème étage</p>
<p>Bâtiment B3 Médecine</p>
<p>15 Bd Maréchal de Lattre de Tassigny 21000 Dijon, France</p>
<p><a href="https://linkedin.com/in/alexisvarin/" class="external-link uri">https://linkedin.com/in/alexisvarin/</a></p>
<p><a href="https://umr-right.com/" class="external-link uri">https://umr-right.com/</a></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you find this package useful and would like to cite it, please find the citation information below :</p>
<p>Varin, Alexis. (2024). RightSeuratTools: An R Package Providing Complementary Tools for the Manipulation and Visualization of Single Cell RNA-Seq Data in a Seurat Object. Zenodo. <a href="https://doi.org/10.5281/zenodo.12518909" class="external-link uri">https://doi.org/10.5281/zenodo.12518909</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Alexis-Varin/RightSeuratTools/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Alexis-Varin/RightSeuratTools/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RightSeuratTools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alexis Varin <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0001-3474-7263" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://doi.org/10.5281/zenodo.12518910" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.12518910.svg" alt="DOI"></a></li>
<li><a href="https://github.com/Alexis-Varin/RightSeuratTools" class="external-link"><img src="https://img.shields.io/badge/devel%20version-1.0.1-orange.svg"></a></li>
<li><a href="https://github.com/Alexis-Varin/RightSeuratTools/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Alexis-Varin/RightSeuratTools/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/Alexis-Varin/RightSeuratTools" class="external-link"><img src="https://img.shields.io/github/languages/code-size/Alexis-Varin/RightSeuratTools.svg"></a></li>
<li><a href="https://github.com/Alexis-Varin/RightSeuratTools/commits/main" class="external-link"><img src="https://img.shields.io/github/last-commit/Alexis-Varin/RightSeuratTools.svg"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexis Varin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
