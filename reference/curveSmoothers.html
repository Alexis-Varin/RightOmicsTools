<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Scatterplot of log-transformed counts, and average fitted GAM smoother curves along pseudotime — curveSmoothers • RightOmicsTools</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Scatterplot of log-transformed counts, and average fitted GAM smoother curves along pseudotime — curveSmoothers"><meta name="description" content="This function generates a scatterplot of the log-transformed counts, and displays on top the average fitted GAM smoother curves, computed using fitGAM, along pseudotime, and is a reworked version of plotSmoothers, it allows for the plotting of multiple genes simultaneously, as well as selected lineages and conditions. Additionally, the scatterplot is rasterized to reduce the size of the output file and branching points may be displayed on each curve. Finally, the log-transformed counts and average fitted GAM smoother curves are rescaled to the same range between genes to allow for a better comparison."><meta property="og:description" content="This function generates a scatterplot of the log-transformed counts, and displays on top the average fitted GAM smoother curves, computed using fitGAM, along pseudotime, and is a reworked version of plotSmoothers, it allows for the plotting of multiple genes simultaneously, as well as selected lineages and conditions. Additionally, the scatterplot is rasterized to reduce the size of the output file and branching points may be displayed on each curve. Finally, the log-transformed counts and average fitted GAM smoother curves are rescaled to the same range between genes to allow for a better comparison."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RightOmicsTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/RightOmicsTools.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Visualization.html">Advanced Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/GSEA.html">Creating gene signatures from GSEA pathways</a></li>
    <li><a class="dropdown-item" href="../articles/tradeSeq.html">Analysis of DEG along pseudotime</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Alexis-Varin/RightOmicsTools/issues">Issues</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Alexis-Varin/RightOmicsTools/discussions">Feedbacks</a></li>
<li class="nav-item"><a class="nav-link" href="../authors.html">Citation</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://orcid.org/0009-0001-3474-7263">About</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Alexis-Varin/RightOmicsTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Scatterplot of log-transformed counts, and average fitted GAM smoother curves along pseudotime</h1>
      <small class="dont-index">Source: <a href="https://github.com/Alexis-Varin/RightOmicsTools/blob/main/R/curveSmoothers.R" class="external-link"><code>R/curveSmoothers.R</code></a></small>
      <div class="d-none name"><code>curveSmoothers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a scatterplot of the log-transformed counts, and displays on top the average fitted GAM smoother curves, computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code>, along pseudotime, and is a reworked version of <code><a href="https://rdrr.io/pkg/tradeSeq/man/plotSmoothers.html" class="external-link">plotSmoothers</a></code>, it allows for the plotting of multiple genes simultaneously, as well as selected lineages and conditions. Additionally, the scatterplot is rasterized to reduce the size of the output file and branching points may be displayed on each curve. Finally, the log-transformed counts and average fitted GAM smoother curves are rescaled to the same range between genes to allow for a better comparison.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">curveSmoothers</span><span class="op">(</span></span>
<span>  <span class="va">models</span>,</span>
<span>  predictSmooth.df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genes <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">predictSmooth.df</span><span class="op">)</span><span class="op">)</span> <span class="cn">NA</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">predictSmooth.df</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span>,</span>
<span>  <span class="va">lineages</span>,</span>
<span>  lineages.to.remove <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conditions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  facets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genes"</span>, <span class="st">"conditions"</span><span class="op">)</span>,</span>
<span>  nPoints <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  branch.points <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rescale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rescale.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  points.size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  points.alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  curves.width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  curves.alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  facets.scales <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>  facets.axes <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis.text.size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  axis.title.size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  facets.title.size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  legend.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend.text.size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p>A <span class="pkg">SingleCellExperiment</span> object containing the fitted GAM smoothers, computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code>, with or without <code>conditions</code> provided.</p></dd>


<dt id="arg-predictsmooth-df">predictSmooth.df<a class="anchor" aria-label="anchor" href="#arg-predictsmooth-df"></a></dt>
<dd><p>A <code>data.frame</code> object containing the average fitted GAM smoothers, computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/predictSmooth.html" class="external-link">predictSmooth</a></code> with <code>nPoints</code>, <code>lineages</code> and <code>tidy</code> = <code>TRUE</code>. If <code>NULL</code>, average fitted GAM smoothers will be internally computed.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character. The names of one or several genes to plot the log-transformed counts and the average fitted GAM smoothers from.</p></dd>


<dt id="arg-lineages">lineages<a class="anchor" aria-label="anchor" href="#arg-lineages"></a></dt>
<dd><p>Numeric. The indices of the lineages (for example, c(1, 5), 2:4 etc) to plot the log-transformed counts, the average fitted GAM smoothers and the pseudotime values from.</p></dd>


<dt id="arg-lineages-to-remove">lineages.to.remove<a class="anchor" aria-label="anchor" href="#arg-lineages-to-remove"></a></dt>
<dd><p>Numeric. The lineages to exclude from <code><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></code>. Useful if you want to remove the influence of other lineages in a comparison.</p></dd>


<dt id="arg-conditions">conditions<a class="anchor" aria-label="anchor" href="#arg-conditions"></a></dt>
<dd><p>Character. The names of one or several <code>conditions</code> identities to select. If <code>NULL</code>, all identities are used, and each unique condition will be plotted, for each of the <code>lineages</code> provided (for example, if you have four lineages and three conditions, twelve curves will be plotted). Ignored if the <code>models</code> object was computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> without <code>conditions</code>. Please note that if the <code>models</code> object was computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> with <code>conditions</code>, it is not possible to plot global lineages (without <code>conditions</code>), you would need to compute a new <code>models</code> object using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> without <code>conditions</code>. This is due to a limitation in how <code><a href="https://rdrr.io/pkg/tradeSeq/man/predictSmooth.html" class="external-link">predictSmooth</a></code> returns average fitted GAM smoothers (if the <code>models</code> object was computed with <code>conditions</code>, the function will always mean the fitted GAM smoothers for each lineage and each condition independently).</p></dd>


<dt id="arg-facets">facets<a class="anchor" aria-label="anchor" href="#arg-facets"></a></dt>
<dd><p>Character. The names of one or two metadata among 'genes', 'lineages' and/or 'conditions' to facet the plot. If one metadata is provided, <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code> will be used, and if two are provided, <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></code> will be used, with the first metadata as rows and the second as columns. If the <code>models</code> object was computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> without <code>conditions</code>, you cannot facet by 'conditions'. Please note that if the <code>models</code> object was computed using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> with <code>conditions</code>, it is not possible to plot global lineages (without <code>conditions</code>), you would need to compute a new <code>models</code> object using <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> without <code>conditions</code>. This is due to a limitation in how <code><a href="https://rdrr.io/pkg/tradeSeq/man/predictSmooth.html" class="external-link">predictSmooth</a></code> returns average fitted GAM smoothers (if the <code>models</code> object was computed with <code>conditions</code>, the function will always mean the fitted GAM smoothers for each lineage and each condition independently).</p></dd>


<dt id="arg-npoints">nPoints<a class="anchor" aria-label="anchor" href="#arg-npoints"></a></dt>
<dd><p>Numeric. (from <code><a href="https://rdrr.io/pkg/tradeSeq/man/predictSmooth.html" class="external-link">predictSmooth</a></code> documentation) The number of points used to create the grid along the smoother for each lineage.</p></dd>


<dt id="arg-branch-points">branch.points<a class="anchor" aria-label="anchor" href="#arg-branch-points"></a></dt>
<dd><p>Numeric, Character or List. Branching points may be shown on the fitted GAM smoother curves, to partition the lineages and help visualize differences. Either one or more pseudotime values to plot the branching points at, and/or one or several values containing 'knot' followed by a number (for example, 'knot2', 'knot4' etc), which correspond to the knots (<code>k</code>) input in <code><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></code> and which divide each lineage into segments; the function will extract the pseudotime values from each knot number and plot the branching points. Mixing any of the two options is possible (for example, c(4.3, 7, 'knot4')). You may also provide a <code>list</code> containing any of the two options, and named after one or several identities of a single metadata among 'genes', 'lineages' or 'conditions' (for example, list('CD4' = c(2, 'knot5')) which will only plot branching points on CD4 curves). For <code>lineages</code>, the <code>list</code> names need to be provided as 'Lineage' (with capital L) followed by the index (for example, list('Lineage1' = c(4.3, 'knot4'), 'Lineage2' = c('knot2', 7, 9)), which will only plot branching points on lineage 1 and 2 curves). Finally, you may also provide identities corresponding to several metadata at the same time by pasting them together with '_' (for example, list('Lineage1_CD4' = c(1, 'knot1', 12)), which will only plot branching points on lineage 1 and CD4 curves).</p></dd>


<dt id="arg-rescale">rescale<a class="anchor" aria-label="anchor" href="#arg-rescale"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, average fitted GAM smoothers will be adjusted using <code><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></code> between the first numerical value of <code>rescale.range</code> (lowest value) and the second numerical value (highest value). This is different than <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></code> as this doesn't compare values to any mean or standard deviation and is therefore not a Z-score, it only refits each value (independently for each gene) in order to visualize all <code>genes</code> in the same dimension regardless of their differences in fitted GAM smoothers.</p></dd>


<dt id="arg-rescale-range">rescale.range<a class="anchor" aria-label="anchor" href="#arg-rescale-range"></a></dt>
<dd><p>Numeric. The minimum and maximum values to resize the average fitted GAM smoothers and internally passed to <code><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></code>. These values are arbitrary and will not change the visualization, only the values in the legend. Ignored if <code>rescale</code> = <code>FALSE</code>.</p></dd>


<dt id="arg-points-size">points.size<a class="anchor" aria-label="anchor" href="#arg-points-size"></a></dt>
<dd><p>Numeric. The size of the log-transformed count points.</p></dd>


<dt id="arg-points-alpha">points.alpha<a class="anchor" aria-label="anchor" href="#arg-points-alpha"></a></dt>
<dd><p>Numeric. The transparency of the log-transformed count points.</p></dd>


<dt id="arg-curves-width">curves.width<a class="anchor" aria-label="anchor" href="#arg-curves-width"></a></dt>
<dd><p>Numeric. The width of the fitted GAM smoother curves.</p></dd>


<dt id="arg-curves-alpha">curves.alpha<a class="anchor" aria-label="anchor" href="#arg-curves-alpha"></a></dt>
<dd><p>Numeric. The transparency of the fitted GAM smoother curves.</p></dd>


<dt id="arg-facets-scales">facets.scales<a class="anchor" aria-label="anchor" href="#arg-facets-scales"></a></dt>
<dd><p>Character. (from <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></code> documentation) Are scales shared across all facets (the default, "<code>fixed</code>"), or do they vary across rows ("<code>free_x</code>"), columns ("<code>free_y</code>"), or both rows and columns ("<code>free</code>")?</p></dd>


<dt id="arg-facets-axes">facets.axes<a class="anchor" aria-label="anchor" href="#arg-facets-axes"></a></dt>
<dd><p>Character. (from <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></code> documentation) Determines which axes will be drawn. When "<code>margins</code>" (default), axes will be drawn at the exterior margins. "<code>all_x</code>" and "<code>all_y</code>" will draw the respective axes at the interior panels too, whereas "<code>all</code>" will draw all axes at all panels.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>Character. The color names for each identity of the metadata excluded from <code>facets</code> among 'genes', 'lineages' and/or 'conditions' (for example, if <code>facets</code> = c('genes', 'conditions'), the <code>colors</code> will be for each of the <code>lineages</code> provided, or if <code>facets</code> = 'lineages', the <code>colors</code> will be for each of the <code>genes</code> times <code>conditions</code> provided). If <code>NULL</code>, uses <span class="pkg">Seurat</span>'s default colors.</p></dd>


<dt id="arg-axis-text-size">axis.text.size<a class="anchor" aria-label="anchor" href="#arg-axis-text-size"></a></dt>
<dd><p>Numeric. The font size of the pseudotime and log-transformed counts.</p></dd>


<dt id="arg-axis-title-size">axis.title.size<a class="anchor" aria-label="anchor" href="#arg-axis-title-size"></a></dt>
<dd><p>Numeric. The font size of the axis title.</p></dd>


<dt id="arg-facets-title-size">facets.title.size<a class="anchor" aria-label="anchor" href="#arg-facets-title-size"></a></dt>
<dd><p>Numeric. The font size of the facet titles.</p></dd>


<dt id="arg-legend-names">legend.names<a class="anchor" aria-label="anchor" href="#arg-legend-names"></a></dt>
<dd><p>Character. You may provide custom names for the colors displayed in the legend, instead of the default names (for example, if <code>facets</code> = c('genes', 'conditions'), the color names will be 'Lineage' followed by the index of the <code>lineages</code> provided, you may replace these with any other names).</p></dd>


<dt id="arg-legend-text-size">legend.text.size<a class="anchor" aria-label="anchor" href="#arg-legend-text-size"></a></dt>
<dd><p>Numeric. The font size of the legend text.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>Numeric. The number of rows to use for the facets. Ignored if two metadata are provided to <code>facets</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <span class="pkg">ggplot2</span> object.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexis Varin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

